<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context"
       xmlns:mongo="http://www.springframework.org/schema/data/mongo"
       xmlns:jee="http://www.springframework.org/schema/jee"
       xsi:schemaLocation="http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd http://www.springframework.org/schema/data/mongo http://www.springframework.org/schema/data/mongo/spring-mongo-1.1.xsd http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-3.1.xsd">

       <mongo:mongo host="${mongodb.host}" port="${mongodb.port}">
              <!-- <mongo:options connections-per-host="${mongodb.max.connections}"
                     connect-timeout="${mongodb.connection.timeout}" max-wait-time="${mongodb.wait.time}" /> -->
       </mongo:mongo>

       <bean id="mongoTemplate" class="org.springframework.data.mongodb.core.MongoTemplate">
              <constructor-arg name="mongoDbFactory" ref="mongoDbFactory" />
       </bean>

       <bean id="mongoDbFactory" class="org.springframework.data.mongodb.core.SimpleMongoDbFactory">
              <constructor-arg ref="mongo" />
              <constructor-arg ref="mongoCredentials" />
              <constructor-arg name="databaseName" value="${mongodb.database.name}" />
       </bean>
       
       
       
		
		<bean id="dbImpl" class="com.metricstream.systemi.jpa.util.JPAManager" />
		
		<bean id="DBInstance" class="com.metricstream.systemi.rga.dao.DBInstance" factory-method="getInstance">
			<property name="dbInstance" ref="dbImpl"/>
		</bean>  
	       

<!--        <bean id="mongoCredentials" class="org.springframework.data.authentication.UserCredentials"> 
              <constructor-arg name="username" value="${mongodb.username}" /> 
              <constructor-arg name="password" value="${mongodb.password}" />
		</bean> -->

       <bean id="mongoCredentials" class="com.msi.grcintelligence.utility.encryption.UserCredentials">
              <constructor-arg name="username" value="${mongodb.username}" />
              <constructor-arg name="password" value="${mongodb.password}" />
       </bean>


       <bean id="jndiPropertyConfigurer"
              class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
              <property name="ignoreUnresolvablePlaceholders" value="true" />
              <property name="locations">
                     <list>
                           <bean class="org.springframework.core.io.FileSystemResource">
                                  <constructor-arg>
                                         <bean class="org.springframework.jndi.JndiObjectFactoryBean">
                                                <property name="jndiName" value="java:/comp/env/jndi/MongoDB" />
                                                <property name="resourceRef" value="true" />
                                         </bean>
                                  </constructor-arg>
                           </bean>
                     </list>
              </property>
       </bean>

</beans>
