<?xml version="1.0" encoding="UTF-8"?><FUNCTION_SPEC xmlns="http://www.metricstream.com" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.metricstream.com ms_application_schema.xsd">
<!--$Revision: 1.30.2.12.2.2.2.9.2.8 $-->
<!--$Author: prao $-->
<PLATFORM_DETAILS>
<PLATFORM_VERSION>6.1</PLATFORM_VERSION>
<BUILD_VERSION>3.1.1.0</BUILD_VERSION>
</PLATFORM_DETAILS>
<STORED_PROCEDURE_NAME>MS_RGA_VIRTUAL_REP_ID</STORED_PROCEDURE_NAME>
<OBJECT_ID>MS_RGA_VIRTUAL_REP_ID</OBJECT_ID>
<OBJECT_TYPE>FUNCTION</OBJECT_TYPE>
<TEXT>Function             MS_RGA_virtual_rep_id(p_report_name varchar2) 
RETURN NUMBER IS 
x_report_id NUMBER; 
y_report_id NUMBER; 
x_cnt NUMBER; 
PRAGMA AUTONOMOUS_TRANSACTION; 
BEGIN
FOR cur_user IN (SELECT DISTINCT user_id FROM si_user_infocenter WHERE virtual_infocenter_id 
in (select INFOCENTER_ID from SI_USER_INFOCENTER where USER_ID = 
(select USER_ID from SI_USERS_T where USER_NAME = 'SYSTEMI') 
AND infocenter_name IN ('GRCI Hidden'))) 
LOOP SELECT report_id INTO y_report_id
FROM si_reports a, si_users b
WHERE a.created_by = b.user_id 
AND user_name = 'SYSTEMI' 
AND report_name = p_report_name; 

SELECT COUNT(1) INTO x_cnt FROM si_user_reports 
WHERE user_id = cur_user.user_id 
AND virtual_report_id = y_report_id; 

dbms_output.put_line('Count is ' || x_cnt); 

IF x_cnt = 0 THEN dbms_output.put_line('insert for User id ' || cur_user.user_id); 
INSERT INTO si_user_reports 
VALUES (cur_user.user_id, si_reports_s.NEXTVAL, SYSDATE, NULL, 100000, SYSDATE, 100000, SYSDATE, NULL, NULL, y_report_id); 
END IF; 
END LOOP; 
commit; 
return x_cnt;
EXCEPTION WHEN OTHERS 
THEN RETURN NULL; 
END MS_RGA_virtual_rep_id; </TEXT>
</FUNCTION_SPEC>
